<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>HEVC 扩展直链跳转</title>
  <style>
    body{margin:0;padding:40px;font-family:Arial,Helvetica,sans-serif;background:#f7f7f7;text-align:center}
    #msg{font-size:18px;color:#333}
    #msg.error{color:#c00}
  </style>
</head>
<body>
  <div id="msg">正在获取直链，请稍候 …</div>

<script>
  (async () => {
    const url = 'https://cfrp.996855.xyz/https://store.rg-adguard.net/api/GetFiles';
    const body = new URLSearchParams({
      type: 'ProductId',
      url: '9n4wgh0z6vhq',   // HEVCVideoExtension 的 ProductId，可改
      ring: 'RP',
      lang: 'zh-CN'
    });

    try {
      const res = await fetch(url, {
        method: 'POST',
        body: body,
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded',
          'User-Agent': 'Mozilla/5.0 (Linux; Android 13; Pixel 7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Mobile Safari/537.36',
          'Referer': 'https://store.rg-adguard.net/'
        }
      });

      if (!res.ok) throw new Error('网络响应异常');

      const text = await res.text();
      // 返回的是一段 HTML，我们直接用正则粗暴抽 .appxbundle 链接
      const match = text.match(/https?:\/\/[^"\s]+\.appxbundle(?:\?[^"\s]*)?/i);
      if (!match) throw new Error('未找到 .appxbundle 下载地址');

      // 跳转下载
      location.href = match[0];
    } catch (e) {
      document.getElementById('msg').textContent = '出错了：' + e.message;
      document.getElementById('msg').className = 'error';
    }
  })();
</script>
</body>
</html>
